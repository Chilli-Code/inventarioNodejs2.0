<style>
  .div-info-update {
    width: 100%;
    flex: 1;
    max-height: 100%;
    display: flex;
    margin-top: 30px;

  }

  @media only screen and (max-width: 701px) {
    .div-info-update {
      flex-direction: column;
    }
  }

  .container-sub-usuarios {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }

  .app-content-actions {
    width: 100%;
  }

  .btn-add-sub-users {
    background: var(--action-color);
    border: none;
    cursor: pointer;
    border-radius: 10px;
    padding: 4px;
    transition: 0.5s;
  }

  .btn-add-sub-users:hover {
    transform: scale(1.1);
  }

  .filter-agregar-from:before {
    left: 88%;
  }

  @media screen and (max-width: 520px) {
    .app-content-actions .app-content-actions-wrapper {
      margin-left: initial !important;
    }
  }

  .swal2-styled.swal2-confirm {
    background-color: rgb(221, 51, 51) !important;
  }
</style>
<% if (successMessage && successMessage.length) { %>
  <div class="alert alert-success">
    <%= successMessage %>
  </div>
  <% } %>
    <% if (errorMessage && errorMessage.length) { %>
      <div class="alert alert-danger">
        <%= errorMessage %>
      </div>
      <% } %>
        <div class="div-info-update">
          <div class="footer">
            <div class="lottie-animation" style="height:auto; width:400px;overflow:hidden;"
              data-animation-path="/Lottie/welcome-animation.json"></div>
          </div>
          <div class="container-sub-usuarios">
            <div class="app-content-actions">
              <h2 class="app-content-headerText">Usuarios de ventas</h2>
              <div class="app-content-actions-wrapper">
                <button class="btn-add-sub-users filter-product">
                  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                    fill="#fff" class="icon">
                    <path
                      d="M440-280h80v-160h160v-80H520v-160h-80v160H280v80h160v160Zm40 200q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z" />
                  </svg>
                </button>
                <div class="filter-button-wrapper">
                  <div class="filter-agregar-from">
                    <form action="/settings/subusuarios/add" method="POST">

                      <label>Nombre de usuario</label>
                      <input name="subuser_name" type="text" required>
                      <input type="submit" class="filter-button apply agregaar" value="Agregar">
                    </form>
                  </div>
                </div>
              </div>

            </div>
            <div class="tableView products-area-wrapper">
              <table>
                <thead class="products-header">
                  <tr>
                    <th class="product-cell padding color: var(--app-content-main-color);" style="padding: 2px 20px;">
                      N°
                    </th>
                    <th class="product-cell padding color: var(--app-content-main-color);">
                      Nombre
                    </th>
                    <th class="product-cell padding color: var(--app-content-main-color);">
                      Utl.venta
                    </th>
                    <th class="product-cell padding color: var(--app-content-main-color);">
                      Total
                    </th>
                    <th class="product-cell padding color: var(--app-content-main-color);">
                      Accion
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <% subusers.forEach((s, i)=> { %>
                    <tr class="products-row articulo busquedaExitosa">
                      <td class="product-cell tituloProduct padd">
                        <%= i + 1 %>
                      </td>
                      <td class="product-cell tituloProduct busqueda">
                        <%= s.nombre %>
                      </td>
                      <td class="product-cell tituloProduct busqueda">
                        <%= s.tipo %>
                      </td>
                      <td>
                        <form action="/settings/subusuarios/delete/<%= s._id %>" method="POST" style="display:inline;">
                          <button type="submit" class="Menu-opciones-articulos-eliminar btnHover btn-eliminar"
                            data-id="<%= user._id %>">
                            <svg id="Layer_1" data-name="Layer 1" height="24px" xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 105.16 122.88">
                              <defs>
                                <style>
                                  .cls-1 {
                                    fill-rule: evenodd;
                                  }
                                </style>
                              </defs>
                              <title>Eliminar</title>
                              <path class="cls-1"
                                d="M11.17,37.16H94.65a8.4,8.4,0,0,1,2,.16,5.93,5.93,0,0,1,2.88,1.56,5.43,5.43,0,0,1,1.64,3.34,7.65,7.65,0,0,1-.06,1.44L94,117.31v0l0,.13,0,.28v0a7.06,7.06,0,0,1-.2.9v0l0,.06v0a5.89,5.89,0,0,1-5.47,4.07H17.32a6.17,6.17,0,0,1-1.25-.19,6.17,6.17,0,0,1-1.16-.48h0a6.18,6.18,0,0,1-3.08-4.88l-7-73.49a7.69,7.69,0,0,1-.06-1.66,5.37,5.37,0,0,1,1.63-3.29,6,6,0,0,1,3-1.58,8.94,8.94,0,0,1,1.79-.13ZM5.65,8.8H37.12V6h0a2.44,2.44,0,0,1,0-.27,6,6,0,0,1,1.76-4h0A6,6,0,0,1,43.09,0H62.46l.3,0a6,6,0,0,1,5.7,6V6h0V8.8h32l.39,0a4.7,4.7,0,0,1,4.31,4.43c0,.18,0,.32,0,.5v9.86a2.59,2.59,0,0,1-2.59,2.59H2.59A2.59,2.59,0,0,1,0,23.62V13.53H0a1.56,1.56,0,0,1,0-.31v0A4.72,4.72,0,0,1,3.88,8.88,10.4,10.4,0,0,1,5.65,8.8Zm42.1,52.7a4.77,4.77,0,0,1,9.49,0v37a4.77,4.77,0,0,1-9.49,0v-37Zm23.73-.2a4.58,4.58,0,0,1,5-4.06,4.47,4.47,0,0,1,4.51,4.46l-2,37a4.57,4.57,0,0,1-5,4.06,4.47,4.47,0,0,1-4.51-4.46l2-37ZM25,61.7a4.46,4.46,0,0,1,4.5-4.46,4.58,4.58,0,0,1,5,4.06l2,37a4.47,4.47,0,0,1-4.51,4.46,4.57,4.57,0,0,1-5-4.06l-2-37Z">
                              </path>
                            </svg>
                          </button>
                        </form>
                      </td>
                    </tr>
                    <% }) %>
                </tbody>
              </table>
            </div>
          </div>

        </div>



        <script>
          document.querySelectorAll('.btn-eliminar').forEach(button => {
            button.addEventListener('click', function (event) {
              event.preventDefault();  // <--- PREVENIR ENVÍO AUTOMÁTICO
              const form = this.closest('form');
              Swal.fire({
                title: '¿Estás seguro?',
                text: "Esta acción no se puede deshacer.",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Sí, eliminar',
                cancelButtonText: 'Cancelar'
              }).then((result) => {
                if (result.isConfirmed) {
                  form.submit();  // <--- Ahora sí envía el formulario solo si confirma
                }
              });
            });
          });
        </script>